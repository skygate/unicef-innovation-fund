<dom-module id="submit-page">
  <template>
    <style is="custom-style">
    .container {
      max-width: 1150px;
      text-align: center;
    }

    .container--wide {
      max-width: 1920px;
    }

    .button:hover {
      background-color: #FFFFFF;
      box-shadow: 2px 2px 10px 0 #999999;
      z-index: 1;
    }

    .button__text {
      margin-bottom: 35px;
    }

    .button__image {
      max-height: 80px;
    }

    .button--big {
      background-color: #FFFFFF;
      color: #0099FF;
      float: left;
      font-size: 1.2rem;
      height: 252px;
      padding: 0;
      text-transform: none;
      width: 50%;
    }

    .submit__icon {
      display: block;
    }

    .section__header {
      color: #0099FF;
      font-size: 1.57rem;
      line-height: 4rem;
    }

    .section__description {
      font-size: 1.54rem;
      line-height: 1.45;
      margin: 9rem 0 2.5rem;
    }

    .section__user-email {
      margin-top: 3.7rem;
    }

    .section__submit {
      background-color: #0099FF;
      color: #FFFFFF !important;
      /* Overwrite MDL default style */
      font-size: 1.6rem;
      font-weight: 400;
      height: inherit;
      letter-spacing: 0.05rem;
      margin-top: 1.1rem;
      padding: 1rem 3.2rem;
      text-transform: none;
    }

    .section__submit:hover {
      background-color: #77C2E2;
    }

    .section__break {
      border-top: 2px solid #727272;
      margin: 4.8rem 0 5.9rem;
    }

    .section__subheader {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: 0.05rem;
      margin-bottom: 3rem;
      text-transform: uppercase;
    }

    .section__icon {
      width: 22%;
    }

    .section__link {
      text-decoration: none;
    }

    .section__back {
      background-color: transparent;
      border: none;
      float: left;
      font-size: 1rem;
      text-decoration: underline;
      text-transform: uppercase;
    }

    .section__input {
      border: 2px solid #BABCBD;
      color: #0099FF;
      display: block;
      font-size: 1.1rem;
      margin: 0 auto;
      padding: 1.1rem;
      width: 332px;
    }

    .section__input--authenticated {
        background: url('../images/confirm.svg') no-repeat 97% center;
        background-size: 7%;
    }

    .section__input:focus {
        outline: none
    }

    .section__confirm-email {
      background-color: #0099FF;
      border: none;
      color: #FFFFFF;
      font-size: 1.6rem;
      font-weight: 400;
      margin-top: 0.8rem;
      padding: 1rem 0;
      text-transform: uppercase;
      width: 365px;
    }

    .section__confirm-email:disabled {
      background-color: #BABCBD;
      color: #000000;
    }

    .faq__name {
      font-size: 1.25rem;
      font-weight: 600;
      margin: 1.3rem 0;
      text-align: left;
    }

    .faq__link {
      float: right;
      font-weight: 400;
      text-decoration: none;
    }

    .faq__description {
      font-size: 1.25rem;
      line-height: 1.4;
      letter-spacing: 0.094rem;
      margin-bottom: 4.1rem;
      text-align: left;
    }

    .js-visible {
      opacity: 1;
      visibility: visible;
    }

    .js-hidden {
      opacity: 0;
      visibility: hidden;
      max-height: 0;
    }

    button.fade-in{
        animation-delay: 0.525s !important;
    }

    .is-alert {
        color: red !important;
    }

    .timeline {
        list-style-type: none;
        margin-right: 0;
        margin-left: auto;
        text-align: left;
        width: 60%;
    }

    .timeline__section {

    }

    .timeline__header {
        position: relative;
    }

    .timeline__number {
        border: 1px solid #33B8B8;
        border-radius: 50%;
        color: #33B8B8;
        display: inline-block;
        left: -7%;
        line-height: 0.50;
        padding: 1rem;
        position: absolute;
    }

    .timeline__summary {
        font-weight: 600;
    }

    .description__list {
        color: #5D5D5D;
        list-style-type: none;
    }

    .description__item {

    }

    @media (max-width: 1120px) {
      .button--big {
        font-size: 2rem;
        height: 250px;
      }
    }

    @media (max-width: 920px) {
      .section__back {
        float: none;
      }
    }

    @media (min-width: 680px) {
      .button:first-of-type:after {
        border-right: 2px solid #58595B;
        content: '';
        height: 60%;
        position: absolute;
        right: 0;
        top: 50%;
        transform: translateY(-50%);
      }
    }

    @media (max-width: 680px) {
      .button--big {
        display: block;
        float: none;
        width: 100%;
      }
    }

    </style>
    <style is="custom-style" include="style-fade-in"></style>
    <firebase-document
      app-name="test"
      path="/summary/portfolios/invested_youth_engagement"
      data="{{emails}}">
    </firebase-document>
    <header class='page__header page__header--dark'>
      <div class='mdl-grid container' style='position:relative;'>
        <div class="mdl-layout-spacer"></div>
        <div class="mdl-cell mdl-cell--10-col">
          <h1 class='page__header--title fade-in'>Submit</h1>
          <p class="page__header--type">[[sectionName]]</p>
        </div>
        <div class="mdl-layout-spacer"></div>
      </div>
    </header>
    <div class="mdl-grid js-visible" data-target="main">
      <div class="mdl-layout-spacer"></div>
      <div class="container--wide mdl-cell mdl-cell--12-col">
        <button on-tap="changeSection" class="button button--big mdl-button mdl-js-button mdl-js-ripple-effect fade-in" data-display="office" data-hide="main">
          <p class="button__text">Submissions by UNICEF country offices</p>
          <img src="../images/icons/country_offices.png" alt="Submissions by country offices" class="button__image"/>
        </button>
        <button on-tap="changeSection" class="button button--big mdl-button mdl-js-button mdl-js-ripple-effect fade-in" data-display="startup" data-hide="main">
          <p class="button__text">Submissions by start-ups</p>
          <img src="../images/icons/startups.png" alt="Submissions by country offices" class="button__image"/>
        </button>
      </div>
      <div class="mdl-layout-spacer"></div>
    </div>
    <div class="mdl-grid js-hidden" data-target="office">
      <div class="mdl-layout-spacer"></div>
      <div class="container mdl-cell mdl-cell--12-col">
        <button on-tap="changeSection" class="section__back" id="back-from-office" data-display="main" data-hide="office">Back</button>
        <p class$="section__description [[authTextClass]]">[[emailVerificationMessage]]</p>
        <form is="iron-form" class="section__form" on-submit="submitEmail">
          <input type="text" class$="section__input [[inputAuthClass]]" placeholder="email address" on-input="checkAuth">
          <button type="submit" class="section__confirm-email" data-display="office-submited" data-hide="office" disabled="[[isDisabled]]">continue</button>
        </form>
      </div>
      <div class="mdl-layout-spacer"></div>
    </div>
    <div class="mdl-grid js-hidden" data-target="office-submited">
      <div class="mdl-layout-spacer"></div>
      <div class="container mdl-cell mdl-cell--12-col">
        <button on-tap="changeSection" class="section__back" data-display="main" data-hide="office-submited">Back</button>
        <strong class="section__description">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Excepturi est ducimus, nemo laborum esse repellat accusamus, repudiandae officia neque voluptatum id. Facilis iste odit eligendi perspiciatis, sed hic nesciunt maiores?</strong>
        <p class="section__user-email"></p>
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdL7bKFc-zSzm4R4wK5eKsKRzW_HqQsdPYyA62sCXR84BrF9A/viewform?usp=send_form" class="section__submit mdl-button mdl-js-button mdl-js-ripple-effect">Submission Form</a>
        <hr class="section__break">
        <h3 class="section__subheader">What is the application process?</h3>
        <ol class="timeline">
            <li class="timeline__section">
                <h4 class="timeline__header">
                    <p class="timeline__number">1</p>CHECK ELIGIBILITY (3 minutes)
                </h4>
                <p class="timeline__summary">Country office meets the following criteria:</p>
                <ul class="description__list">
                    <li class="description__item">Is developing and piloting a new open source solution.</li>
                    <li class="description__item">Solution has completed initial prototyping and small scale piloting with promising results Lacks su icient evidence or resources to scale further.</li>
                    <li class="description__item">Has matching co-funding to support the project.</li>
                    <li class="description__item">Senior management supports the application and project itself</li>
                    <li class="description__item">Can submit as many applications as they have projects (e.g. 4,5, 6 etc).</li>
                    <li class="description__item">Are able to spend the investment within 12 months</li>
                </ul>
            </li>
            <li class="timeline__section">
                <h4 class="timeline__header">
                    <p class="timeline__number">2</p>SUBMIT (50 minutes)
                </h4>
                <p class="timeline__summary">Apply on a rolling basis through a simple application form found here.There is no deadline for submission.</p>
                <p class="timeline__summary">Applications are initially assessed based on a number of criteria, which include:</p>
                <ul class="description__list">
                    <li class="description__item">Alignment with UNICEF’s Innovation Principles and UNICEF’s global priorities for children Placement within one of the Fund’s three portfolio areas</li>
                    <li class="description__item">Size of the market opportunity and relevance across geographic locations</li>
                    <li class="description__item">Suitability of the team to implement the project</li>
                    <li class="description__item">Creation of open source, public goods</li>
                    <li class="description__item">Results able to be measured and monitored in real time</li>
                </ul>
            </li>
        </ol>
      </div>
      <div class="mdl-layout-spacer"></div>
    </div>
    <div class="mdl-grid js-hidden" data-target="startup">
      <div class="mdl-layout-spacer"></div>
      <div class="container mdl-cell mdl-cell--12-col">
        <button on-tap="changeSection" class="section__back" data-display="main" data-hide="startup">Back</button>
        <h3 class="section__header">STARTUP</h3>
        <p class="section__description">The next call for submissions from start-ups and academic institutions is planned for December 2016. Please follow us on Twitter <a href="https://twitter.com/unicefinnovate" class="section__link">@unicefinnovate</a>, where we will share updates about the Fund and future submission opportunities and deadlines.</p>
        <p class="section__description">If you submitted an Expression of Interest in the last round (closed on 26 February 2016), only selected companies/institutions have been contacted with information about next steps. Thank you for your submission nd interest in the Innovation Fund.</p>
        <hr class="section__break">
        <h3 class="section__subheader">Resources</h3>
        <img src="../images/icons/resources.png" alt="" class="section__icon">
        <h4 class="faq__name">Short Background Note<a href="https://drive.google.com/file/d/0BwC3tr7jXADzNXJTNzk4d01qams/view?usp=sharing" class="faq__link">Download</a></h4>
        <p class="faq__description">The Innovation Fund allows UNICEF to quickly assess, fund and scale open-source solutions that have been developed by companies in new and emerging markets. The Innovation Fund supports the generation of open source, public goods that address the most pressing challenges facing children. The Innovation Fund brings together models of financing and methodologies used by Venture Capital funds and the principles of UNICEF'S award winning Innovation Unit. </p>
        <h4 class="faq__name">Innovation Principles<a href="http://www.unicefstories.org/principles/" class="faq__link">Download</a></h4>
        <p class="faq__description">The following set of principles represents a concerted effort by donors to capture the most important lessons learned by the development community in the implementation of technology-enabled programs. Having evolved from a previous set of implementer precepts endorsed by over 300 organizations, these principles seek to serve as a set of living guidelines that are meant to inform, but not dictate, the design of technology-enabled development programs.</p>
      </div>
      <div class="mdl-layout-spacer"></div>
    </div>
  </template>
  <script>
  Polymer({
    is: "submit-page",
    properties: {
        isDisabled: {
            type: Boolean,
            value: true,
            observer: 'checkAuthInputClass'
        },
        emailVerificationMessage: {
            type: String,
            value: "Please submit your email address to continue"
        },
        authTextClass: {
            type: String,
            value: ''
        },
        inputAuthClass: {
            type: String,
            value: ''
        },
        sectionName: {
            type: String,
            value: ''
        }
    },
    listeners: {
      'iron-form-submit': 'submitEmail'
    },
    ready: function () {
        var self = this;
        var visibleClass = "js-visible";
        var hiddenClass = "js-hidden";
        $(document).on('page-changed', function(e, page_id){
            if (page_id !== 'about') {
                if (!self.selected) {
                    var currentElement = self.$$("." + visibleClass);
                    var mainElement = self.$$("[data-target='main']");

                    currentElement.classList.remove(visibleClass);
                    currentElement.classList.add(hiddenClass);

                    mainElement.classList.remove(hiddenClass);
                    mainElement.classList.add(visibleClass);
                }
            }
        });
    },
    checkAuth: function (event) {
        var regxTest = /.{1,}@unicef\.org$/gi;
        var defaultEmailVerificationText = "Please submit your email address to continue";
        var inputValue = event.target.value;
        var authErrorClass = 'is-alert';

        if (regxTest.test(inputValue) === true) {
            this.emailVerificationMessage = defaultEmailVerificationText;
            this.authTextClass = '';
            return this.isDisabled = false;
        } else if (inputValue.indexOf('@') !== -1) {
            this.emailVerificationMessage = "This email is not valid";
            this.authTextClass = authErrorClass
            return this.isDisabled = true;
        } else {
            this.emailVerificationMessage = defaultEmailVerificationText;
            this.authTextClass = '';
            return this.isDisabled = true;
        }
    },
    checkAuthInputClass: function () {
        if (this.isDisabled) {
            return this.inputAuthClass = '';
        } else {
            return this.inputAuthClass = 'section__input--authenticated';
        }
    },
    toggleVisible: function(toHide, toShow) {
      var visibleClass = "js-visible";
      var hiddenClass = "js-hidden";

      toHide.classList.remove(visibleClass);
      toHide.classList.add(hiddenClass);

      toShow.classList.remove(hiddenClass);
      toShow.classList.add(visibleClass);
    },
    changeSection: function(event) {
      var hide = event.target.dataset.hide || event.target.parentElement.dataset.hide;
      var target = event.target.dataset.display || event.target.parentElement.dataset.display;

      switch (target) {
          case "office" || "office-submited":
              this.sectionName = "UNICEF Country Offices";
              break;
          case "startup":
              this.sectionName = "Startups";
              break;
          default:
              this.sectionName = "";
      }

      var toHide = this.$$("[data-target='" + hide + "']");
      var toShow = this.$$("[data-target='" + target + "']");

      this.toggleVisible(toHide, toShow);
    },
    submitEmail: function(event) {
      event.preventDefault();
      var emailAddress = this.$$(".section__input").value;

      this.$$(".section__user-email").innerHTML = emailAddress;

      var submitButton = this.$$('.section__confirm-email');

      var toHide = this.$$("[data-target='" + submitButton.dataset.hide + "']");
      var toShow = this.$$("[data-target='" + submitButton.dataset.display + "']");

      this.toggleVisible(toHide, toShow);
    }
  })
  </script>
</dom-module>
